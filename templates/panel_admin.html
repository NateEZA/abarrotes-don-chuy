{% extends "base.html" %}
{% block titulo %}Panel Admin - Abarrotes Don Chuy{% endblock %}
{% block contenido %}
<h1 style="color: #2c3e50; margin-bottom: 2rem;">Panel de Control - Administrador</h1>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
    <div style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        <h3 style="font-size: 2.5rem; margin-bottom: 0.5rem;">{{ total_usuarios }}</h3>
        <p style="font-size: 1.1rem; opacity: 0.9;">Total Usuarios</p>
    </div>
    <div style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        <h3 style="font-size: 2.5rem; margin-bottom: 0.5rem;">{{ total_productos }}</h3>
        <p style="font-size: 1.1rem; opacity: 0.9;">Total Productos</p>
    </div>
    <div style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        <h3 style="font-size: 2.5rem; margin-bottom: 0.5rem;">{{ total_ordenes }}</h3>
        <p style="font-size: 1.1rem; opacity: 0.9;">Total Ventas</p>
    </div>
    <div style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        <h3 style="font-size: 2.5rem; margin-bottom: 0.5rem;">${{ "%.2f"|format(ingresos_totales) }}</h3>
        <p style="font-size: 1.1rem; opacity: 0.9;">Ingresos Totales</p>
    </div>
</div>

{% if productos_pendientes %}
<div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 3rem;">
    <h2 style="color: #2c3e50; margin-bottom: 1.5rem;">‚ö†Ô∏è Productos Pendientes de Aprobaci√≥n</h2>
    <table class="tabla">
        <thead><tr><th>Producto</th><th>Vendedor</th><th>Precio</th><th>Stock</th><th>Fecha</th><th>Acci√≥n</th></tr></thead>
        <tbody>
            {% for producto in productos_pendientes %}
            <tr>
                <td>{{ producto.nombre }}</td>
                <td>{{ producto.vendedor.nombre_usuario }}</td>
                <td>${{ "%.2f"|format(producto.precio) }}</td>
                <td>{{ producto.stock }}</td>
                <td>{{ producto.fecha_creacion.strftime('%d/%m/%Y') }}</td>
                <td>
                    <form method="POST" action="{{ url_for('aprobar_producto', id_producto=producto.id) }}" style="display: inline;">
                        <button type="submit" class="btn btn-primario" style="padding: 0.5rem 1rem;">Aprobar</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<div style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 2rem;">
    <h2 style="color: #2c3e50; margin-bottom: 1.5rem;">üì¶ Historial de Ventas Recientes</h2>
    {% if ordenes_recientes %}
    <table class="tabla">
        <thead><tr><th>ID Orden</th><th>Comprador</th><th>Total</th><th>Estado</th><th>Fecha</th><th>Items</th></tr></thead>
        <tbody>
            {% for orden in ordenes_recientes %}
            <tr>
                <td>#{{ orden.id }}</td>
                <td>{{ orden.comprador.nombre_usuario }}</td>
                <td style="color: #27ae60; font-weight: bold;">${{ "%.2f"|format(orden.total) }}</td>
                <td><span style="background: {% if orden.estado == 'Completada' %}#d4edda{% else %}#fff3cd{% endif %}; color: {% if orden.estado == 'Completada' %}#155724{% else %}#856404{% endif %}; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.9rem;">{{ orden.estado }}</span></td>
                <td>{{ orden.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</td>
                <td>{{ orden.items|length }} producto(s)</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="text-align: center; color: #7f8c8d; padding: 2rem;">No hay ventas registradas a√∫n.</p>
    {% endif %}
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
    <a href="{{ url_for('admin_usuarios') }}" class="btn btn-secundario" style="text-align: center;">üë• Gestionar Usuarios</a>
    <a href="{{ url_for('index') }}" class="btn btn-secundario" style="text-align: center;">üì¶ Ver Productos</a>
</div>
{% endblock %}